
\section{Algorithm} \label{sec:algorithm}

As a means of producing fewer energy violations when scheduling system tasks, a technique known as the \emph{Smooth to Average Method (STAM)} was created. This scheduling heuristic takes into account the average overall energy requirements of all tasks in a given system taskset. This energy average is then used to modify the given taskset to ensure that the energy consumption of each task is at or near the calculated threshold. This smoothing of energy consumption is done by creating a virtual task set with modified start and end times to allow energy consumption to be distributed over a large time interval. To accomplish this smoothing, tasks are still executed at their physical runtimes, but during the virtual period, more energy is able to be generated by the environmental source reducing the net energy consumption over the runtime of each task.

\begin{algorithm}[tb]
\label{stamalg}
\begin{algorithmic}
\STATE INPUT: $realTasks$ \COMMENT {list of [period, duration, energy]} 
\STATE INPUT: $N$ \COMMENT {number of tasks}
\STATE OUTPUT: $vTasks$ \COMMENT {same format as $realTasks$}
\STATE $meanEnergy \gets mean(realTasks[:,3])$
\FOR{$i = 1$ \TO $N$}
\IF{$taskList[i,3] > meanEnergy$}
\STATE $taskEnergy \gets realTasks[i, 2] * realTasks[i,3]$
\STATE $vDuration \gets \lceil \frac{taskEnergy}{meanEnergy} \rceil$
\STATE $vEnergy \gets \frac{taskEnergy}{vDuration}$
\STATE $vTasks[i,:] \gets [taskList[i,1]~~vDuration~~vEnergy]$
\ELSE
\STATE $vTasks[i,:] \gets taskList[i,:]$
\ENDIF
\ENDFOR
\end{algorithmic}
\caption{Smooth to Average Method (STAM)}
\end{algorithm}